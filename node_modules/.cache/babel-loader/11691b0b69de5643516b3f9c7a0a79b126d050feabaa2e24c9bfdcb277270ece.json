{"ast":null,"code":"/* global window */\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n0 && (module.exports = {\n  Router: null,\n  default: null,\n  withRouter: null,\n  useRouter: null,\n  createRouter: null,\n  makePublicRouterInstance: null\n});\nfunction _export(target, all) {\n  for (var name in all) Object.defineProperty(target, name, {\n    enumerable: true,\n    get: all[name]\n  });\n}\n_export(exports, {\n  Router: function () {\n    return _router.default;\n  },\n  // Export the singletonRouter and this is the public API.\n  default: function () {\n    return _default;\n  },\n  withRouter: function () {\n    return _withrouter.default;\n  },\n  useRouter: function () {\n    return useRouter;\n  },\n  createRouter: function () {\n    return createRouter;\n  },\n  makePublicRouterInstance: function () {\n    return makePublicRouterInstance;\n  }\n});\nconst _interop_require_default = require(\"@swc/helpers/_/_interop_require_default\");\nconst _react = /*#__PURE__*/_interop_require_default._(require(\"react\"));\nconst _router = /*#__PURE__*/_interop_require_default._(require(\"../shared/lib/router/router\"));\nconst _routercontextsharedruntime = require(\"../shared/lib/router-context.shared-runtime\");\nconst _iserror = /*#__PURE__*/_interop_require_default._(require(\"../lib/is-error\"));\nconst _withrouter = /*#__PURE__*/_interop_require_default._(require(\"./with-router\"));\nconst singletonRouter = {\n  router: null,\n  readyCallbacks: [],\n  ready(callback) {\n    if (this.router) return callback();\n    if (typeof window !== \"undefined\") {\n      this.readyCallbacks.push(callback);\n    }\n  }\n};\n// Create public properties and methods of the router in the singletonRouter\nconst urlPropertyFields = [\"pathname\", \"route\", \"query\", \"asPath\", \"components\", \"isFallback\", \"basePath\", \"locale\", \"locales\", \"defaultLocale\", \"isReady\", \"isPreview\", \"isLocaleDomain\", \"domainLocales\"];\nconst routerEvents = [\"routeChangeStart\", \"beforeHistoryChange\", \"routeChangeComplete\", \"routeChangeError\", \"hashChangeStart\", \"hashChangeComplete\"];\nconst coreMethodFields = [\"push\", \"replace\", \"reload\", \"back\", \"prefetch\", \"beforePopState\"];\n// Events is a static property on the router, the router doesn't have to be initialized to use it\nObject.defineProperty(singletonRouter, \"events\", {\n  get() {\n    return _router.default.events;\n  }\n});\nfunction getRouter() {\n  if (!singletonRouter.router) {\n    const message = \"No router instance found.\\n\" + 'You should only use \"next/router\" on the client side of your app.\\n';\n    throw new Error(message);\n  }\n  return singletonRouter.router;\n}\nurlPropertyFields.forEach(field => {\n  // Here we need to use Object.defineProperty because we need to return\n  // the property assigned to the actual router\n  // The value might get changed as we change routes and this is the\n  // proper way to access it\n  Object.defineProperty(singletonRouter, field, {\n    get() {\n      const router = getRouter();\n      return router[field];\n    }\n  });\n});\ncoreMethodFields.forEach(field => {\n  singletonRouter[field] = function () {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n    const router = getRouter();\n    return router[field](...args);\n  };\n});\nrouterEvents.forEach(event => {\n  singletonRouter.ready(() => {\n    _router.default.events.on(event, function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      const eventField = \"on\" + event.charAt(0).toUpperCase() + event.substring(1);\n      const _singletonRouter = singletonRouter;\n      if (_singletonRouter[eventField]) {\n        try {\n          _singletonRouter[eventField](...args);\n        } catch (err) {\n          console.error(\"Error when running the Router event: \" + eventField);\n          console.error((0, _iserror.default)(err) ? err.message + \"\\n\" + err.stack : err + \"\");\n        }\n      }\n    });\n  });\n});\nconst _default = singletonRouter;\nfunction useRouter() {\n  const router = _react.default.useContext(_routercontextsharedruntime.RouterContext);\n  if (!router) {\n    throw new Error(\"NextRouter was not mounted. https://nextjs.org/docs/messages/next-router-not-mounted\");\n  }\n  return router;\n}\nfunction createRouter() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n  singletonRouter.router = new _router.default(...args);\n  singletonRouter.readyCallbacks.forEach(cb => cb());\n  singletonRouter.readyCallbacks = [];\n  return singletonRouter.router;\n}\nfunction makePublicRouterInstance(router) {\n  const scopedRouter = router;\n  const instance = {};\n  for (const property of urlPropertyFields) {\n    if (typeof scopedRouter[property] === \"object\") {\n      instance[property] = Object.assign(Array.isArray(scopedRouter[property]) ? [] : {}, scopedRouter[property]) // makes sure query is not stateful\n      ;\n      continue;\n    }\n    instance[property] = scopedRouter[property];\n  }\n  // Events is a static property on the router, the router doesn't have to be initialized to use it\n  instance.events = _router.default.events;\n  coreMethodFields.forEach(field => {\n    instance[field] = function () {\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n      return scopedRouter[field](...args);\n    };\n  });\n  return instance;\n}\nif ((typeof exports.default === 'function' || typeof exports.default === 'object' && exports.default !== null) && typeof exports.default.__esModule === 'undefined') {\n  Object.defineProperty(exports.default, '__esModule', {\n    value: true\n  });\n  Object.assign(exports.default, exports);\n  module.exports = exports.default;\n}","map":{"version":3,"names":["Router","_router","default","_default","withRouter","_withrouter","useRouter","createRouter","makePublicRouterInstance","singletonRouter","router","readyCallbacks","ready","callback","window","push","urlPropertyFields","routerEvents","coreMethodFields","Object","defineProperty","get","events","getRouter","message","Error","forEach","field","args","Array","_len","_key","arguments","event","on","eventField","charAt","toUpperCase","substring","_singletonRouter","err","console","error","_iserror","stack","_react","useContext","_routercontextsharedruntime","RouterContext","length","cb","scopedRouter","instance","property","assign","isArray"],"sources":["../../src/client/router.ts"],"sourcesContent":[null],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}